<!DOCTYPE html>
<head>
<meta charset="utf-8"></meta>
    <style>
        @font-face {
            font-family: math-font;
            src: url(https://fred-wang.github.io/MathFonts/TeXGyreSchola/texgyreschola-math.woff2);
        }
        math {
            font-family: math-font;
        }
        body{
            font-family:Calibri;
            max-width: 50em;
            margin: auto;
            padding: 10px;
            background-color: #1c1c1c;
            color: white;
        }
        table{
            margin: 1em 0 1em 0;
        }
        table,tr,th,td{
            border: 1px solid #474747;
            border-collapse: collapse;
            text-align: left;
            vertical-align: top;
        }
        img{
            max-width: 100%;
        }
        a {
            color: #287cff
        }
    </style>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head><h4 id="способы-тактирования-мк">Способы тактирования МК</h4>
<p><strong>Внутренний генератор</strong>:</p>
<ul>
<li>Как правило на базу внутренней RC цепи</li>
<li>Не требует внешних подключений</li>
<li>Ограничен выбор частот</li>
</ul>
<p><strong>Внутренний генератор с внешней RC цепью</strong>:</p>
<ul>
<li>Частота определяется номиналами R &amp; C</li>
<li>Широкий выбор частот</li>
<li>Требует внешних подключений</li>
</ul>
<p><img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312103427%20darkmode.png"
alt="Pasted image 20250312103427%20darkmode.png" /></p>
<p><strong>Внутренний генератор с внешним кварцевым
резонатором</strong>:</p>
<ul>
<li>Частота по сравнению с RC цепью меньше зависит от температуры</li>
<li>Нужна внешняя схема</li>
</ul>
<p><img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312103645%20darkmode.png"
alt="Pasted image 20250312103645%20darkmode.png" /></p>
<p><strong>Внешний генератор</strong>:<br />
Хорош для синхронной работы нескольких устройств<br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312103704%20darkmode.png"
alt="Pasted image 20250312103704%20darkmode.png" /></p>
<h4 id="схема-тактирования-atmega8515">Схема тактирования
ATmega8515</h4>
<p>Источник тактового сигнала выбирается FUSE битами:<br />
Прикол разделения тактрования - по одному отрубать модули коль надо</p>
<table>
<thead>
<tr class="header">
<th>Device clocking option</th>
<th>CKSEL3.0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>External Crystal/Ceramic Resonator</td>
<td>1111-1010</td>
</tr>
<tr class="even">
<td>External Low-Frequency Crystal</td>
<td>1001</td>
</tr>
<tr class="odd">
<td>Externa RC Oscillator</td>
<td>1000-0101</td>
</tr>
<tr class="even">
<td>Calibrated Internal RC Oscillator</td>
<td>0100-0001</td>
</tr>
<tr class="odd">
<td>External Clock</td>
<td>0000</td>
</tr>
</tbody>
</table>
<p><img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312104207%20darkmode.png"
alt="Pasted image 20250312104207%20darkmode.png" /></p>
<h4 id="кварцевые-резонаторы-и-генераторы">Кварцевые резонаторы и
генераторы</h4>
<p><strong>Резонатор</strong> - пассивный девайс, ему нужны внешние
генератор сигнала и ограничители нагрузки<br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312104745%20darkmode.png"
alt="Pasted image 20250312104745%20darkmode.png" /><br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312104837%20darkmode.png"
alt="Pasted image 20250312104837%20darkmode.png" /><br />
Частный случай - 32768 Гц (~32 кГц) - часовые кварцевые резонаторы<br />
<strong>Генератор (осциллятор)</strong> - активный девайс, резонатор +
осциллятор в одном<br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312105159%20darkmode.png"
alt="Pasted image 20250312105159%20darkmode.png" /><br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312105214%20darkmode.png"
alt="Pasted image 20250312105214%20darkmode.png" /><br />
^ милашка :3</p>
<h4 id="обощённая-схема-таймерасчётчика">Обощённая схема
таймера/счётчика</h4>
<p><img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312105730%20darkmode.png"
alt="Pasted image 20250312105730%20darkmode.png" /><br />
// Pretty straightforward if you ask me lol</p>
<h4 id="применение-таймеровсчётчиков">Применение таймеров/счётчиков</h4>
<table>
<thead>
<tr class="header">
<th>Компонент</th>
<th>Применение</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Счётчик, на вход которого подан тактовый сигнал МК</td>
<td>Отсчёт заданного интервала времени ака <strong>таймер</strong></td>
</tr>
<tr class="even">
<td>Счётчик, на вход которого подан внешний сигнал</td>
<td>Подсчёт внешних событий ака <strong>счётчик</strong></td>
</tr>
<tr class="odd">
<td>Счётчик + схема захвата</td>
<td>Измерение интервала времени ака <strong>секундомер</strong>. В
частности для определения внешних сигналов</td>
</tr>
<tr class="even">
<td>Счётчик + порт в/в</td>
<td>Формирование одиночных импульсов с заданными длительностью и
задержкой</td>
</tr>
<tr class="odd">
<td>Счётчик + схема сравнения + порт в/в</td>
<td>Формирование периодических сигналов с заданными параметрами
(частота, скважность, сдвиг фаз). В частности:<br>- Деление частоты<br>-
ШИМ-сигнал</td>
</tr>
</tbody>
</table>
<h4 id="таймер---отсчёт-времени-и-событий">Таймер - отсчёт времени и
событий</h4>
<p>Отсчёт - переполнен счётчик -&gt; прошло время, паникуй, кидай
прерывание, fuck midgets, hail Satan<br />
<strong>Частота счёта</strong> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mfrac displaystyle="true"><mn>1</mn><msub><mi>T</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub></mfrac><mo>=</mo><mfrac displaystyle="true"><msub><mi>F</mi><mrow><mi>c</mi><mi>k</mi></mrow></msub><mi>K</mi></mfrac></mrow><annotation encoding="application/x-tex">F_{cnt}=\dfrac{1}{T_{cnt}}=\dfrac{F_{ck}}{K}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>C</mi><mi>K</mi></mrow></msub><annotation encoding="application/x-tex">F_{CK}</annotation></semantics></math>
- тактовая частота МК<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
- предделитель (см. схему выше)<br />
<strong>Интервал времени</strong> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>N</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>T</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><msub><mi>N</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac displaystyle="true"><mi>K</mi><msub><mi>F</mi><mrow><mi>c</mi><mi>k</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">t=(N_{max}-N_0)T_{cnt}=(2^n-N_0)\dfrac{K}{F_{ck}}</annotation></semantics></math><br />
<strong>Начальное значение</strong> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>0</mn></msub><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mfrac displaystyle="true"><mrow><mi>t</mi><msub><mi>F</mi><mrow><mi>c</mi><mi>k</mi></mrow></msub></mrow><mi>K</mi></mfrac></mrow><annotation encoding="application/x-tex">N_0=2^n-\dfrac{tF_{ck}}{K}</annotation></semantics></math></p>
<p><img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312110753%20darkmode.png"
alt="Pasted image 20250312110753%20darkmode.png" /></p>
<h4 id="таймер---функция-захвата">Таймер - функция захвата</h4>
<p>Захват - значения из счётчика. Есть сигнал на захват - хватай уёбка
сажай в регистр флагов<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mfrac displaystyle="true"><msub><mi>F</mi><mrow><mi>c</mi><mi>k</mi></mrow></msub><mi>K</mi></mfrac><mo>=</mo><mfrac displaystyle="true"><mn>1</mn><msub><mi>T</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">F_{cnt}=\dfrac{F_{ck}}{K}=\dfrac{1}{T_{cnt}}</annotation></semantics></math><br />
<strong>Измеряемый интервал времени</strong> -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi><mo>=</mo><msub><mi>t</mi><mn>2</mn></msub><mo>−</mo><msub><mi>t</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mn>2</mn></msub><mo>−</mo><msub><mi>N</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>T</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mn>2</mn></msub><mo>−</mo><msub><mi>N</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac displaystyle="true"><mi>K</mi><msub><mi>F</mi><mrow><mi>c</mi><mi>k</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\Delta t=t_2-t_1=(N_2-N_1)T_{cnt}=(N_2-N_1)\dfrac{K}{F_{ck}}</annotation></semantics></math><br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312111056%20darkmode.png"
alt="Pasted image 20250312111056%20darkmode.png" /></p>
<h4 id="таймер---функция-сравнения">Таймер - функция сравнения</h4>
<p>Формирует на выходе МК сигналы с заданными параметрами (частота,
скважность (хуй бумажность хыхыхыхы смишно), сдвиг фаз)<br />
Всё в целом тоже просто - каждый такт чекаем дошли до нужного значения
или нет, если дошли - кидаем флаги и прерывание<br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312112012%20darkmode.png"
alt="Pasted image 20250312112012%20darkmode.png" /><br />
<img
src="%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250312112022%20darkmode.png"
alt="Pasted image 20250312112022%20darkmode.png" /></p>
