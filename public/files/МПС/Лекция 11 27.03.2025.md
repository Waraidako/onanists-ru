–•–æ—Ö–ª–æ–≤ —É–º–æ–ª—è–µ—Ç —Ö–æ–¥–∏—Ç—å –Ω–∞ –ª–µ–∫—Ü–∏–∏ –∏–±–æ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã - –ø—Ä–∏–∫–æ–ª—å–Ω–æ, –Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ç–æ–∂–µ –Ω–∏—Ö—É—ë–≤–æ –±—ã–ª–æ –±—ã

#### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã LVDS

![Pasted image 20250327115505.png](%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250327115505.png)
^ –°–∏–≥–Ω–∞–ª—ã LVDS (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ)
![Pasted image 20250327115850.png](%D0%9F%D0%B8%D0%BA%D1%87%D0%B8/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D0%B8/Pasted%20image%2020250327115850.png)
^ –°–∏–Ω—Ñ–∞–∑–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–æ–≤ –Ω–∞ –ú–ö AVR

````
// push-pull
DDRB |= (1 << PB0)
PORTB &= ~(1 << PB0) // 0
PORTB |= (1 << PB0) //1
````

````
// open-drain emulation
#include <avr/io.h>

// Set pin as open-drain
#define OPEN_DRAIN_SET_LOW(pin) \
	do { DDRB |= (1 << pin); PORTB &= ~(1 << pin); } \
	while(0)
#define OPEN_DRAIN_SET_HIGH(pin) \
	do { DDRB &= ~(1 << pin); PORTB |= (1 << pin); } \
	while(0)

int main(void) {
	OPEN_DRAIN_SET_HIGH(0);
	OPEN_DRAIN_SET_LOW(0);
	return 0;
}
````

–ü—Ä–∏–∫–æ–ª—é—Ö–∞ –ø—Ä–æ –∫–æ–¥ –≤—ã—à–µ:
**Q**: –ü–æ—á–µ–º—É do while(0) –≤ define –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–¥, –≤–∑—è—Ç—ã–π –≤ {}?
**A**: –ö—Ä–∏–≤–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å define + –ø—Ä–∏–∫–æ–ª—ã —Å –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º (–æ–Ω —É–±–µ—Ä—ë—Ç —Ü–∏–∫–ª –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ), —Ç–∞–∫ —á—Ç–æ –µ—Å—Ç—å –æ–±—â–µ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –º–Ω–æ–≥–æ–∫–æ–º–∞–Ω–¥–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã –æ–±—ë—Ä—Ç—ã–≤–∞—é—Ç—Å—è –≤ do while(0)
**Q**: –ü–æ—á–µ–º—É –Ω–µ —Ñ—É–Ω–∫—Ü–∏—è –∞ –º–∞–∫—Ä–æ—Å?
**A**: –≠–∫–æ–Ω–æ–º–∏—è —Ç–∞–∫—Ç–æ–≤. –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ–≥–æ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ –º–∞–∫—Ä–æ—Å –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∫–æ–¥ –∏ –ø–æ—Ö–µ—Ä. –í C++ –µ—Å—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ inline, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–ª–∞ –±—ã —Ñ—É–Ω–∫—Ü–∏—é —Å—Ä–∞–∑—É –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –∫–æ–¥, –Ω–æ:
- –í C –µ—ë –Ω–µ—Ç (—Ç–æ–ª—å–∫–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ–º —Å–µ–π—á–∞—Å –ª–º–∞–æ)
- –í —Å–∞–º–∏—Ö –ø–ª—é—Å–∞—Ö –æ–Ω–∞ –∏–Ω–æ–≥–¥–∞ –∫—Ä–∏–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç üôÉ

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–æ–≤ –Ω–∞ –ú–ö STM32

````
// push-pull
void GPIO_Init(void) {
	// Enable GPIOA clicking
	__HAL_RCC_GPIOA_CLK_ENABLE();
	
	GPIO_InitTypeDef GPIO_InitStruct = {0};
	GPIO_InitStruct.Pin = GPIO_PIN_5;
	// Push-Pull
	GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
	GPIO_InitStruct.Pull = GPIO_NOPULL;
	GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
	HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
}

// Usage
// Enable
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_SET);
// Disable
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_RESET);
````

**Q**: –ü–æ –∫–æ–π —Ö–µ—Ä –Ω—É–∂–µ–Ω HAL?
**A**: –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å. –í—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç —á—Ç–æ-—Ç–æ –Ω–µ–∑–Ω–∞–∏—Ç–µ–ª—å–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å—Å—è –ø–æ —Ç–∏–ø—É –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –∏–ª–∏ —Ç–∞–∫–æ–π —Ö–µ—Ä–Ω–∏. –í —Å—Ç–∞—Ç–∏—á–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–º –∫–æ–¥–µ –≤—Å—ë –ª–æ–º–∞–Ω—ë—Ç—Å—è –Ω–∞—Ö—É–π, –Ω–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ HAL –º–æ–∂–µ—Ç –¥–∞–∂–µ –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —á—Ç–æ-–ª–∏–±–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ Legacy –∫–æ–¥–∞ –Ω–∞ –Ω–æ–≤—ã–µ –ú–ö

````
// open-drain
void GPIO_Init(void) {
	__HAL_RCC_GPIOB_CLK_ENABLE();
	GPIO_InitTypeDef GPIO_InitStruct = {0};
	GPIO_InitStruct.Pin = GPIO_PIN_6;
	// Output Open Drain Mode
	GPIO_InitStruct.Pull = GPIO_PULLUP;
	GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
	HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
}
// OD
HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
// 0
HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
````

````
// tri-state
// Logical 1
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_SET);
// Logical 0
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_SET);
// Z-state
HAL_GPIO_DeInit(GPIOA, GPIO_PIN_5);
````

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–æ–≤ –Ω–∞ –ú–ö ESP32

````
// push-pull
#include "driver/gpio.h"

void app_main() {
	gpio_config_t io_conf = {
		.pin_bit_mask = (1ULL << GPIO_NUM_2),
		.mode = GPIO_MODE_OUTPUT,
		.pull_up_en = GPIO_PULLUP_DISABLE,
		.pull_down_en = GPIO_PULLDOWN_DISABLE,
		.intr_type = GPIO_INTR_DISABLE
	};
	gpio_config(&io_conf);
	
	gpio_set_level(GPIO_NUM_2, 1); // high level
	gpio_set_level(GPIO_NUM_2, 0); // low level
}
````

````
// open-drain
#include "driver/gpio.h"

void app_main() {
	gpio_config_t io_conf = {
		.pin_bit_mask = (1ULL << GPIO_NUM_2),
		.mode = GPIO_MODE_OUTPUT_OD,
		.pull_up_en = GPIO_PULLUP_ENABLE,
		.pull_down_en = GPIO_PULLDOWN_DISABLE,
		.intr_type = GPIO_INTR_DISABLE
	};
	gpio_config(&io_conf)
	
	gpio_set_level(GPIO_NUM_2, 1); // OD
	gpio_set_level(GPIO_NUM_2, 0); // low level
}
````

#### –í—Ö–æ–¥—ã GPIO –ú–ö

* –ë–µ–∑ –ø–æ–¥—Ç—è–∂–∫–∏
* –° –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –ø–æ–¥—Ç—è–∂–∫–æ–π –∫ –ø–∏—Ç–∞–Ω–∏—é
* –° –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ø–æ–¥—Ç—è–∂–∫–æ–π –∫ –∑–µ–º–ª–µ

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–∞ —Å –ø–æ–¥—Ç—è–∂–∫–æ–π –Ω–∞ –ú–ö AVR

````
DDRB &= ~(1 << PB0);
PORTB |= (1 << PB0);
if (PINB & (1 << PINB0)) {
	...
}
````

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–∞ —Å –ø–æ–¥—Ç—è–∂–∫–æ–π –Ω–∞ –ú–ö ESP32

````
gpio_config_t io_conf = {
	.pin_bit_mask = (1ULL << GPIO_NUM_5),
	.mode = GPIO_MODE_INPUT,
	.pull_up_en = GPIO_PULLUP_ENABLE,
	.pull_down_en = GPIO_PULLDOWN_DISABLE,
	.intr_type = GPIO_INTR_DISABLE
};
gpio_config(&io_conf);

if (!gpio_get_level(GPIO_NUM_5)) {
	...
}
````

#### –°—Ö–µ–º–∞ –ø–æ—Ä—Ç–∞ –ú–ö AVR –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

https://www.microchip.com/en-us/product/atmega328p - I/O –ø–æ—Ä—Ç—ã - —Å–µ–∫—Ü–∏—è 13
https://www.arxterra.com/8-atmega-gpio/ - #8: ATmega GPIO - Arxterra
https://microsin.net/programming/avr/gpio-and-alternate-port-functions.html - GPIO –∏ –∞–ª—å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ä—Ç–∞ AVR
RM0090 –≥–ª–∞–≤–∞ 6
AN4899 —Ä–∞–∑–¥–µ–ª 4
https://we.easyelectronics.ru/STM32/prakticheskiy-kurs-stm32-urok-1---gpio-porty-vvoda-vyvoda.html - –∫—É—Å–æ–∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫—É—Ä—Å–∞ STM32
ESP32 Technical Reference Manual Version 5.3 —Ä–∞–∑–¥–µ–ª 4
https://microsin.net/programming/arm/esp32-pinout-reference.html - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –≤—ã–≤–æ–¥–∞–º ESP32
